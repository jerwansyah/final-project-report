\chapter{Deskripsi Solusi}

Bab ini membahas deskripsi umum permasalahan \textit{capstone}, analisis masalah
simulasi yang sudah ada, analisis terhadap objek dan lingkungan yang akan
diimplementasi, analisis solusi yang akan diterapkan untuk mengatasi masalah.

\section{Deskripsi Umum Permasalahan \textit{Capstone}}

Proyek trem otonom menggunakan simulasi untuk mempercepat dan mempermudah
pengujian dan validasi pengembangan model/algoritma \textit{decision making},
persepsi, \textit{localization}, dan \textit{mapping} trem otonom. Tim
\textit{capstone} Tugas Akhir ini merupakan bagian dari tim simulasi yang
bertugas untuk mengembangkan simulasi yang sudah ada. Kemajuan
pengembangan simulasi atau pengembangan SILS dan HILS adalah sebagai berikut:

\begin{enumerate}

	\item Eksplorasi kakas CARLA sebagai simulator.

	CARLA versi 0.9.12 di-\textit{install}. Model angkot dan becak telah diimpor
	sebagai objek statis (bukan kendaraan). Kendaraan model \textit{FireTruck}
	digunakan sebagai kendaraan utama (\textit{ego vehicle}) pengganti trem
	karena model trem belum diintegrasi sebagai kendaraan.

	\item \textit{Web service} telah diimplementasi sebagai jalur komunikasi
	antara simulator CARLA dan Pegasus pada HILS.

	Komunikasi menggunakan \textit{web service} lambat karena jumlah transaksi
	per detik kecil dan simulasi juga lambat. Eksplorasi CARLA ROS Bridge
	dilakukan namun masih belum selesai.

	\item Menguji sensor virtual, mencoba menjalankan algoritma \textit{decision
	making} dan persepsi.

	Sensor virtual diuji apakah layak untuk digunakan sebagai pengganti sensor
	asli. Algoritma \textit{decision making} dan persepsi diuji juga pada HILS.

	\item Membuat rancangan skenario simulasi.

	Rancangan daftar skenario simulasi untuk menguji berbagai skenario dengan
	variabel cuaca, waktu, kecepatan tram, dan lalu lintas yang berbeda.

\end{enumerate}

Dari kemajuan proyek dari tahun sebelumnya dibutuhkan  penyempurnaan algoritma
persepsi berbasis sensor, perbaikan arsitekstur (HILS) atau komunikasi yang
memadai, dan integrasi objek lokal pada skenario simulasi. Tim \textit{capstone}
yang beranggotakan 3 orang bertanggungjawab untuk:

\begin{enumerate}

	\item Mengembangkan mekanisme komunikasi antara HILS yang lebih lancar dan
	lebih cepat.
	\item Membuat implementasi skenario pengujian simulasi.
	\item Mengintegrasikan atau mengimplementasikan objek lokal ke skenario
	simulasi.

\end{enumerate}

% tugas akhir ini bertujuan untuk mengintegrasikan atau mengimplementasikan
% ... agar menyerupai lingkungan di Indonesia

\section{Analisis Masalah Simulasi dan Aset Simulasi}

Simulasi trem otonom untuk saat ini telah diinisiasi namun baru sebatas
eksplorasi simulator CARLA dengan menambahkan beberapa kendaraan dan mengetes
kendaraan dalam simulasi.

%  berdasarkan / kemajuann riset, sudah dbibuat model blabla
% ada model ini dari sebelumnya jadi objek statis
% 1. Model Tram, firetruck jadi ego vehicle
% 2. Becak +
% 3. Sepeda
% 4. Rambu-rambu lokal
% 5. Angkot +
% 6. Gerobak
% 7. Sepeda Motor

% pake carla 0.9.12, di town 02 coba2 ego vehicle menggunakan fire truck

Aset simulasi untuk saat ini baru berupa aset bawaan
dari CARLA. Aset bawaan CARLA seperti peta kota, kendaraan, bangungan, rambu
lalu lintas, dan lain-lain merupakan aset yang mencerminkan kota-kota di Amerika
Serikat pada umumnya. Implementasi objek dan lingkungan Indonesia dibutuhkan
agar simulasi serupa dengan kehidupan nyata di Indonesia sehingga ketika
pengujian strategi kemudi trem otonom memiliki tingkat akurasi dan presisi yang
tinggi. Simulasi yang sesuai dengan keadaan aslinya sangat berpengaruh terhadap
sistem trem otonom.

Modul simulasi ini merupakan bagian dari pengembangan sistem otonom dengan
menggunakan kecerdasan buatan untuk trem. Modul ini bertujuan untuk memenuhi
kebutuhan pengujian virtual strategi kemudi trem otonom dengan simulasi.
Simulasi ini bertujuan untuk melakukan validasi strategi kemudi kecerdasan
buatan trem otonom yang telah dikembangkan. Validasi diperlukan agar kecerdasan
buatan yang dikembangkan dapat beroperasi dengan lancar di lingkungan Indonesia.
Oleh karena itu, dibutuhkan aset simulasi yang sesuai dengan keadaan Indonesia.

\section{Analisis Solusi}

% eksplorasi kakas ?

Permasalahan yang telah dibahas dapat diselesaikan dengan mengubah aset yang
sudah ada atau menambahkan aset baru. Aset seperti peta kota harus dibuat
langsung menggunakan CARLAUE4 atau menggunakan RoadRunner yang kemudian diimpor
ke dalam CARLAUE4. Aset baru yang lain dapat dibuat menggunakan aplikasi
\textit{3D modelling}. Aset dibuat secara lengkap dan rinci agar perilaku aset
sesuai dengan yang asli.

Aset yang telah jadi model 3D-nya selanjutnya dimasukkan ke dalam CARLAUE4.
Proses impor aset ini dilakukan dengan mengikuti panduan yang telah tersedia di
dokumentasi CARLA. Proses impor aset harus dilakukan dengan benar agar perilaku
aset baik dan stabil untuk simulasi. Terdapat aset khusus yang harus ditambahkan
ke dalam file 3D model kendaraan dan diatur ke model kendaraan. Aset khusus
tersebut merupakan aset \textit{bone} untuk \textit{rigging} roda kendaraan.
Setelah pengaturan aset dalam CARLAUE4 selesai, dilakukan verifikasi aset dengan
cara menjalankan simulasi dan mengamati cara kendaraan beroperasi. Implementasi
aset berupa kendaraan bus telah berhasil dilakukan pada penelitian lain
\parencite{related-work-xiang}. Proses implementasi kendaraan bus dilakukan
dengan membuat model 3D bus, mengimpor model 3D bus ke dalam CARLAUE4, mengedit
aset bus tersebut dalam CARLAUE4, dan memverifikasi hasil impor aset bus
tersebut.

% TODO: ? cara import aset yang lain (yang khusus, yang detail di bawah aja)
% adding details maybe

Implementasi objek dan lingkungan Indonesia yang akan dilakukan adalah dengan
menambahkan aset dan membuat aset baru. Implementasi yang menambahkan aset
meliputi kendaraan, rambu lalu lintas, dan lingkungan sederhana. Kendaraan yang
akan diimplementasikan adalah trem otonom, angkot, becak, gerobak, motor, dan
sepeda onthel. Trem akan dipasangkan berbagai sensor seperti LIDAR, kamera RGB,
dan Radar untuk menangkap lingkungan sekitar.

% - Langkah-langkah menuju solusi dan penjelasan

% - Alur umum algoritma / langkah-langkah pengembangan sistem (jelaskan)
%   a. cara import/nambahin aset lain:
%      - props: signs, gedung?
%      - peta baru/buat?
%      - testing/validating asetnya udah masuk dan behave bener atau belum
%   b. cara nambahin sensor di trem
%   c. asset customization

%% - Kakas yang diperlukan
Pada proses implementasi aset membutuhkan simulator CARLA dan CARLAUE4 yang
dibangun atau di-\textit{compile} sendiri bukan menggunakan program atau
\textit{binary} yang sudah di-\textit{compile}.
% Proses membangun kedua program ini membutuhkan program ...
Dibutuhkan aplikasi \textit{3D modelling} seperti Blender untuk membuat aset.
Aplikasi RoadRunner akan digunakan untuk membuat aset peta.

\section{Rancangan Implementasi Objek dan Lingkungan Indonesia di Simulator CARLA}

Proses implementasi objek dan lingkungan di simulator CARLA dilakukan dengan
langkah-langkah sebagai berikut.

\begin{enumerate}

	\item Membuat aset baru dengan Blender dan RoadRunner jika diperlukan.

	Aset dibuat mengikuti panduan yang sudah ada di dokumentasi CARLA.
	% Hal tersebut meliputi bentuk poligon, jumlah poligon, dan lain-lain.

	\item Melakukan impor dan edit aset ke dalam CARLAUE4.

	Aset yang ingin dimasukkan ke lingkungan simulasi dan diedit harus dilakukan
	dengan aplikasi CARLAUE4.

	% untuk import vehicles:
	% https://carla.readthedocs.io/en/0.9.13/tuto_A_add_vehicle/#bind-and-model-the-vehicle
	% untuk buat peta:
	% https://carla.readthedocs.io/en/0.9.13/tuto_M_generate_map/

	% links:
	% https://carla.readthedocs.io/en/0.9.13/tuto_A_add_props/
	% https://carla.readthedocs.io/en/0.9.13/tuto_A_material_customization/

	\item Melakukan validasi aset yang telah diimpor.

	Validasi aset dapat dilakukan dengan menjalankan simulator dan mengamati
	aset dalam simulasi. Validasi ini dilakukan untuk memastikan aset yang
	diimpor sudah sesuai dengan yang diinginkan dan stabil dalam simulasi.

	\item Melakukan ekspor aset agar dapat didistribusikan.

	Aset yang ingin digunakan oleh pengguna lain dapat diekspor sehingga
	\textit{portable}. Hal ini dapat dilakukan dengan menjalankan perintah di
	terminal.

	% untuk trem:
	% https://carla.readthedocs.io/en/0.9.13/tuto_G_retrieve_data/#spawn-the-ego-vehicle
\end{enumerate}

% TODO

% jelasin per langkah
% - siapin aset
% - impor aset
